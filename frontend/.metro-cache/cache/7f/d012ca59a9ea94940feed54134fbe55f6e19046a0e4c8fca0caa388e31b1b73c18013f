{"dependencies":[{"name":"@react-native-async-storage/async-storage","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":2,"column":0,"index":33},"end":{"line":2,"column":69,"index":102}}],"key":"0kSRlooyBOaYM9tlTtK91nq+uds=","exportNames":["*"],"imports":1}},{"name":"../store/userStore","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":3,"column":0,"index":104},"end":{"line":3,"column":50,"index":154}}],"key":"IgQi61grymUjzhOUT2rUJCaLs54=","exportNames":["*"],"imports":1}},{"name":"./api","data":{"asyncType":null,"isESMImport":true,"locs":[{"start":{"line":4,"column":0,"index":156},"end":{"line":4,"column":40,"index":196}}],"key":"FbKPDeRJ9TF3vg1eKYKz12urgic=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  var _s = $RefreshSig$(); // frontend/utils/levelState.ts\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  function _interopDefault(e) {\n    return e && e.__esModule ? e : {\n      default: e\n    };\n  }\n  exports.useLevel = useLevel;\n  exports.hydrateLevelIfMissing = hydrateLevelIfMissing;\n  var _reactNativeAsyncStorageAsyncStorage = require(_dependencyMap[0], \"@react-native-async-storage/async-storage\");\n  var AsyncStorage = _interopDefault(_reactNativeAsyncStorageAsyncStorage);\n  var _storeUserStore = require(_dependencyMap[1], \"../store/userStore\");\n  var _api = require(_dependencyMap[2], \"./api\");\n  const KEY = 'fk:selected_level';\n  function normalizeLevel(v) {\n    const s = String(v ?? '').toLowerCase();\n    if (s === 'primaria' || s === 'secundaria') return s;\n    return 'inicial';\n  }\n\n  /**\r\n   * Hook centralizado para leer/escribir el nivel educativo:\r\n   * - Fuente 1: user.selected_level del store.\r\n   * - Fuente 2 (fallback): AsyncStorage si aún no hay user.\r\n   * - Al cambiar nivel: actualiza store, guarda en AsyncStorage y notifica backend (si hay user.id).\r\n   */\n  function useLevel() {\n    _s();\n    const user = (0, _storeUserStore.useUserStore)(s => s.user);\n    const setUser = (0, _storeUserStore.useUserStore)(s => s.setUser);\n\n    // 1) nivel desde el usuario si existe\n    let raw = user?.selected_level;\n\n    // 2) compat: si alguna vez quedó “educationLevel/difficulty”\n    if (!raw) {\n      const st = _storeUserStore.useUserStore.getState?.();\n      raw = st?.educationLevel ?? st?.difficulty ?? raw;\n    }\n    const level = normalizeLevel(raw);\n    const setLevel = async next => {\n      const normalized = normalizeLevel(next);\n\n      // a) Actualizar store\n      if (user && typeof setUser === 'function') {\n        try {\n          setUser({\n            ...user,\n            selected_level: normalized\n          });\n        } catch {}\n      }\n\n      // b) Persistir localmente\n      try {\n        await AsyncStorage.default.setItem(KEY, normalized);\n      } catch {}\n\n      // c) Notificar backend (opcional si hay user)\n      try {\n        if (user?.id) await (0, _api.updateUserLevel)(user.id, normalized).catch(() => {});\n      } catch {}\n    };\n    return {\n      level,\n      setLevel\n    };\n  }\n\n  /** Hidrata el nivel desde AsyncStorage cuando aún no hay user cargado. */\n  _s(useLevel, \"r2BZfRoO9w1gRd1tpkX8EeElpzg=\", false, function () {\n    return [_storeUserStore.useUserStore, _storeUserStore.useUserStore];\n  });\n  async function hydrateLevelIfMissing() {\n    try {\n      const stored = await AsyncStorage.default.getItem(KEY);\n      if (!stored) return;\n      const lvl = normalizeLevel(stored);\n      const st = _storeUserStore.useUserStore.getState?.();\n      const user = st?.user;\n      if (user && st?.setUser) {\n        st.setUser({\n          ...user,\n          selected_level: lvl\n        });\n      }\n    } catch {}\n  }\n});","lineCount":94,"map":[[4,27,1,0],[5,2,1,0,"Object"],[5,8,1,0],[5,9,1,0,"defineProperty"],[5,23,1,0],[5,24,1,0,"exports"],[5,31,1,0],[6,4,1,0,"value"],[6,9,1,0],[7,2,1,0],[8,2,1,0],[8,11,1,0,"_interopDefault"],[8,27,1,0,"e"],[8,28,1,0],[9,4,1,0],[9,11,1,0,"e"],[9,12,1,0],[9,16,1,0,"e"],[9,17,1,0],[9,18,1,0,"__esModule"],[9,28,1,0],[9,31,1,0,"e"],[9,32,1,0],[10,6,1,0,"default"],[10,13,1,0],[10,15,1,0,"e"],[11,4,1,0],[12,2,1,0],[13,2,22,0,"exports"],[13,9,22,0],[13,10,22,0,"useLevel"],[13,18,22,0],[13,21,22,0,"useLevel"],[13,29,22,0],[14,2,56,0,"exports"],[14,9,56,0],[14,10,56,0,"hydrateLevelIfMissing"],[14,31,56,0],[14,34,56,0,"hydrateLevelIfMissing"],[14,55,56,0],[15,2,2,0],[15,6,2,0,"_reactNativeAsyncStorageAsyncStorage"],[15,42,2,0],[15,45,2,0,"require"],[15,52,2,0],[15,53,2,0,"_dependencyMap"],[15,67,2,0],[16,2,2,0],[16,6,2,0,"AsyncStorage"],[16,18,2,0],[16,21,2,0,"_interopDefault"],[16,36,2,0],[16,37,2,0,"_reactNativeAsyncStorageAsyncStorage"],[16,73,2,0],[17,2,3,0],[17,6,3,0,"_storeUserStore"],[17,21,3,0],[17,24,3,0,"require"],[17,31,3,0],[17,32,3,0,"_dependencyMap"],[17,46,3,0],[18,2,4,0],[18,6,4,0,"_api"],[18,10,4,0],[18,13,4,0,"require"],[18,20,4,0],[18,21,4,0,"_dependencyMap"],[18,35,4,0],[19,2,8,0],[19,8,8,6,"KEY"],[19,11,8,9],[19,14,8,12],[19,33,8,31],[20,2,10,0],[20,11,10,9,"normalizeLevel"],[20,25,10,23,"normalizeLevel"],[20,26,10,24,"v"],[20,27,10,30],[20,29,10,42],[21,4,11,2],[21,10,11,8,"s"],[21,11,11,9],[21,14,11,12,"String"],[21,20,11,18],[21,21,11,19,"v"],[21,22,11,20],[21,26,11,24],[21,28,11,26],[21,29,11,27],[21,30,11,28,"toLowerCase"],[21,41,11,39],[21,42,11,40],[21,43,11,41],[22,4,12,2],[22,8,12,6,"s"],[22,9,12,7],[22,14,12,12],[22,24,12,22],[22,28,12,26,"s"],[22,29,12,27],[22,34,12,32],[22,46,12,44],[22,48,12,46],[22,55,12,53,"s"],[22,56,12,54],[23,4,13,2],[23,11,13,9],[23,20,13,18],[24,2,14,0],[26,2,16,0],[27,0,17,0],[28,0,18,0],[29,0,19,0],[30,0,20,0],[31,0,21,0],[32,2,22,7],[32,11,22,16,"useLevel"],[32,19,22,24,"useLevel"],[32,20,22,24],[32,22,22,27],[33,4,22,27,"_s"],[33,6,22,27],[34,4,23,2],[34,10,23,8,"user"],[34,14,23,12],[34,17,23,15],[34,21,23,15,"useUserStore"],[34,36,23,27],[34,37,23,27,"useUserStore"],[34,49,23,27],[34,51,23,29,"s"],[34,52,23,35],[34,56,23,40,"s"],[34,57,23,41],[34,58,23,42,"user"],[34,62,23,46],[34,63,23,47],[35,4,24,2],[35,10,24,8,"setUser"],[35,17,24,15],[35,20,24,18],[35,24,24,18,"useUserStore"],[35,39,24,30],[35,40,24,30,"useUserStore"],[35,52,24,30],[35,54,24,32,"s"],[35,55,24,38],[35,59,24,43,"s"],[35,60,24,44],[35,61,24,45,"setUser"],[35,68,24,52],[35,69,24,53],[37,4,26,2],[38,4,27,2],[38,8,27,6,"raw"],[38,11,27,9],[38,14,27,12,"user"],[38,18,27,16],[38,20,27,18,"selected_level"],[38,34,27,32],[40,4,29,2],[41,4,30,2],[41,8,30,6],[41,9,30,7,"raw"],[41,12,30,10],[41,14,30,12],[42,6,31,4],[42,12,31,10,"st"],[42,14,31,17],[42,17,31,21,"useUserStore"],[42,32,31,33],[42,33,31,33,"useUserStore"],[42,45,31,33],[42,46,31,42,"getState"],[42,54,31,50],[42,57,31,53],[42,58,31,54],[43,6,32,4,"raw"],[43,9,32,7],[43,12,32,10,"st"],[43,14,32,12],[43,16,32,14,"educationLevel"],[43,30,32,28],[43,34,32,32,"st"],[43,36,32,34],[43,38,32,36,"difficulty"],[43,48,32,46],[43,52,32,50,"raw"],[43,55,32,53],[44,4,33,2],[45,4,35,2],[45,10,35,8,"level"],[45,15,35,23],[45,18,35,26,"normalizeLevel"],[45,32,35,40],[45,33,35,41,"raw"],[45,36,35,44],[45,37,35,45],[46,4,37,2],[46,10,37,8,"setLevel"],[46,18,37,16],[46,21,37,19],[46,27,37,26,"next"],[46,31,37,40],[46,35,37,45],[47,6,38,4],[47,12,38,10,"normalized"],[47,22,38,20],[47,25,38,23,"normalizeLevel"],[47,39,38,37],[47,40,38,38,"next"],[47,44,38,42],[47,45,38,43],[49,6,40,4],[50,6,41,4],[50,10,41,8,"user"],[50,14,41,12],[50,18,41,16],[50,25,41,23,"setUser"],[50,32,41,30],[50,37,41,35],[50,47,41,45],[50,49,41,47],[51,8,42,6],[51,12,42,10],[52,10,42,12,"setUser"],[52,17,42,19],[52,18,42,20],[53,12,42,22],[53,15,42,25,"user"],[53,19,42,29],[54,12,42,31,"selected_level"],[54,26,42,45],[54,28,42,47,"normalized"],[55,10,42,58],[55,11,42,66],[55,12,42,67],[56,8,42,69],[56,9,42,70],[56,10,42,71],[56,16,42,77],[56,17,42,78],[57,6,43,4],[59,6,45,4],[60,6,46,4],[60,10,46,8],[61,8,46,10],[61,14,46,16,"AsyncStorage"],[61,26,46,28],[61,27,46,28,"default"],[61,34,46,28],[61,35,46,29,"setItem"],[61,42,46,36],[61,43,46,37,"KEY"],[61,46,46,40],[61,48,46,42,"normalized"],[61,58,46,52],[61,59,46,53],[62,6,46,55],[62,7,46,56],[62,8,46,57],[62,14,46,63],[62,15,46,64],[64,6,48,4],[65,6,49,4],[65,10,49,8],[66,8,49,10],[66,12,49,14,"user"],[66,16,49,18],[66,18,49,20,"id"],[66,20,49,22],[66,22,49,24],[66,28,49,30],[66,32,49,30,"updateUserLevel"],[66,36,49,45],[66,37,49,45,"updateUserLevel"],[66,52,49,45],[66,54,49,46,"user"],[66,58,49,50],[66,59,49,51,"id"],[66,61,49,53],[66,63,49,55,"normalized"],[66,73,49,65],[66,74,49,66],[66,75,49,67,"catch"],[66,80,49,72],[66,81,49,73],[66,87,49,79],[66,88,49,80],[66,89,49,81],[66,90,49,82],[67,6,49,84],[67,7,49,85],[67,8,49,86],[67,14,49,92],[67,15,49,93],[68,4,50,2],[68,5,50,3],[69,4,52,2],[69,11,52,9],[70,6,52,11,"level"],[70,11,52,16],[71,6,52,18,"setLevel"],[72,4,52,27],[72,5,52,28],[73,2,53,0],[75,2,55,0],[76,2,55,0,"_s"],[76,4,55,0],[76,5,22,16,"useLevel"],[76,13,22,24],[77,4,22,24],[77,12,23,15,"useUserStore"],[77,27,23,27],[77,28,23,27,"useUserStore"],[77,40,23,27],[77,42,24,18,"useUserStore"],[77,57,24,30],[77,58,24,30,"useUserStore"],[77,70,24,30],[78,2,24,30],[79,2,56,7],[79,17,56,22,"hydrateLevelIfMissing"],[79,38,56,43,"hydrateLevelIfMissing"],[79,39,56,43],[79,41,56,46],[80,4,57,2],[80,8,57,6],[81,6,58,4],[81,12,58,10,"stored"],[81,18,58,16],[81,21,58,19],[81,27,58,25,"AsyncStorage"],[81,39,58,37],[81,40,58,37,"default"],[81,47,58,37],[81,48,58,38,"getItem"],[81,55,58,45],[81,56,58,46,"KEY"],[81,59,58,49],[81,60,58,50],[82,6,59,4],[82,10,59,8],[82,11,59,9,"stored"],[82,17,59,15],[82,19,59,17],[83,6,60,4],[83,12,60,10,"lvl"],[83,15,60,13],[83,18,60,16,"normalizeLevel"],[83,32,60,30],[83,33,60,31,"stored"],[83,39,60,37],[83,40,60,38],[84,6,61,4],[84,12,61,10,"st"],[84,14,61,17],[84,17,61,21,"useUserStore"],[84,32,61,33],[84,33,61,33,"useUserStore"],[84,45,61,33],[84,46,61,42,"getState"],[84,54,61,50],[84,57,61,53],[84,58,61,54],[85,6,62,4],[85,12,62,10,"user"],[85,16,62,14],[85,19,62,17,"st"],[85,21,62,19],[85,23,62,21,"user"],[85,27,62,25],[86,6,63,4],[86,10,63,8,"user"],[86,14,63,12],[86,18,63,16,"st"],[86,20,63,18],[86,22,63,20,"setUser"],[86,29,63,27],[86,31,63,29],[87,8,64,6,"st"],[87,10,64,8],[87,11,64,9,"setUser"],[87,18,64,16],[87,19,64,17],[88,10,64,19],[88,13,64,22,"user"],[88,17,64,26],[89,10,64,28,"selected_level"],[89,24,64,42],[89,26,64,44,"lvl"],[90,8,64,48],[90,9,64,49],[90,10,64,50],[91,6,65,4],[92,4,66,2],[92,5,66,3],[92,6,66,4],[92,12,66,10],[92,13,66,11],[93,2,67,0],[94,0,67,1],[94,3]],"functionMap":{"names":["<global>","normalizeLevel","useLevel","useUserStore$argument_0","setLevel","updateUserLevel._catch$argument_0","hydrateLevelIfMissing"],"mappings":"AAA;ACS;CDI;OEQ;4BCC,kBD;+BCC,qBD;mBEa;yECY,QD;GFC;CFG;OMG;CNW"},"hasCjsExports":false},"type":"js/module"}]}